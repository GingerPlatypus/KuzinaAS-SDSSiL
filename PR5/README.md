# **Практика №5 по предмету СДССиЛ - Threat Hunting**
Выполнил(а) студент Кузина А.С. группы ББМО-02-23
# **Выполнение практики:**

## **Шаг 1. Развертывание ВМ, запуск стенда и проверка Wazuh:**
**ВМ были взяты с практической работы 3, где были реализованы Wazuh-сервер и Wazuh-агент**
### **1.1 Проверка связи между двумя ВМ:** 
![image](images/1.png)
### **1.2 Проверка работоспособности Wazuh-сервера и отображения в нем агента:**
![image](images/2.png)

## **Шаг 2. Установка IDS/IPS утилиты Suricata для передачи обнаружений в Wazuh:**

**Клиентская ВМ**

### **2.1 Установка Suricata на ВМ с агентом Wazuh:**
![image](images/3.png)
![image](images/4.png)
### **2.2 Установка набора правил для корректного обнаружения в Suricata:**
![image](images/5.png)
### **2.3 Выдача прав на файл с правилами Suricata:**
![image](images/6.png)
### **2.4 Настройка конфигурационного файла Suricata:**
![image](images/7.png)
![image](images/8.png)
![image](images/9.png)
### **2.5 Перезапуск Suricata для применения изменений:**
![image](images/10.png)
### **2.6 Настройка конфигурационного файла Wazuh-agent для работы с Suricata:**
![image](images/11.png)
### **2.5 Перезапуск Wazuh-agent для применения изменений:**
![image](images/12.png)

**Серверная ВМ**

### **2.6 Реализация активности на Серверной ВМ направленной на Клиентскую ВМ для обнаружения:**
![image](images/13.png)
### **2.7 Результат обнаружения в Wazuh:**
![image](images/14.png)
![image](images/15.png)
![image](images/16.png)

## **Шаг 3. Установка ThreatHuntingTools утилиты YARA для передачи обнаружений в Wazuh:**

**Клиентская ВМ**

### **3.1 Процесс установки YARA на клиентскую ВМ:**
![image](images/17.png)
![image](images/18.png)
![image](images/19.png)
### **3.2 Проверка установки YARA:**
![image](images/20.png)
![image](images/21.png)
### **3.3 Исправление ошибки при запуске YARA:**
![image](images/22.png)
### **3.4 Установка набора правил для корректных обнаружений YARA:**
![image](images/23.png)
### **3.5 Создание скрипта yara.sh для активного обнаружения YARA:**
![image](images/24.png)
### **3.6 Выдача прав на созданный скрипт yara.sh:**
![image](images/25.png)
### **3.7 Редактирование конфигурационного файла Wazuh-agent для работы с YARA:**
![image](images/26.png)
### **3.8 Перезапуск Wazuh-agent для применения изменений:**
![image](images/27.png)

**Серверная ВМ**

### **3.9 Создание кастомного декодера для YARA:**
![image](images/28.png)
### **3.10 Создание локальных правил для проверки YARA:**
![image](images/29.png)
### **3.11 Редактирование конфигурационного файла Wazuh для работы с YARA:**
![image](images/30.png)
### **3.12 Перезапуск Wazuh для применения изменений:**
![image](images/31.png)
### **3.13 На Клиентской ВМ выполним имитацию вредоносных действий:**
![image](images/32.png)
### **3.14 В Wazuh на Серверной ВМ видим результат обнаружения угроз:**
![image](images/33.png)
![image](images/34.png)

## **Шаг 4. Установка ScanerTools утилиты OpenVAS:**
### **4.1 Установка докера для дальнейшей установки OpenVAS на Клиенствкую ВМ:**
![image](images/35.png)
### **4.2 Процесс установки OpenVAS на Клиенствкую ВМ:**
![image](images/36.png)
![image](images/37.png)
### **4.3 Запуск web-интерфейса OpenVAS:**
![image](images/38.png)
![image](images/39.png)
### **4.4 Проверка конфигураций для сканирования и их обновление:**
![image](images/40.png)
![image](images/41.png)
### **4.5 Запуск сканирования Клиентской ВМ по IP адресу:**
![image](images/42.png)
### **4.6 Отображение нового задания на сканирование в OpenVAS:**
![image](images/43.png)
### **4.7 Результаты проведенного сканирования:**
![image](images/44.png)
![image](images/45.png)
![image](images/46.png)
![image](images/47.png)
### **4.8 Wazuh отображает активности на анализируемом агенте, которые дублируют конфигурации сканирования OpenVAS:**
![image](images/48.png)
